<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="keywords" content=""/>

    <link rel="stylesheet" href="/css/bootstrap.css"> <!-- Bootstrap-Core-CSS -->
    <link href="/css/style.css" rel='stylesheet' type='text/css'/>
    <link href="/css/owl.carousel.css" rel="stylesheet"><!-- Owl-carousel-CSS -->
    <link href="/css/fontawesome-all.css" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Exo+2" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i"
          rel="stylesheet">
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://cdn.staticfile.org/axios/0.18.0/axios.min.js"></script>
    <script src="base/plugins/jquery/jquery.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="base/dist/css/adminlte.min.css">
    <link rel="stylesheet" href="base/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
</head>

<body>
<!--
    作者：offline
    时间：2020-03-04
    描述：头部内容
-->
<header>
    <div class="header">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="index.html">同城搬家供需信息交流平台</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="/userservice/main">首页<span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/u/order">我的团队订单</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/myteammessage">我的团队信息</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/u/contact">我的团队消息</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="/u/myliuyan">我的消息</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="/forteam/notice">告示</a>
                    </li>
                    <li class="nav-item dropdown">
                        <input type="hidden" id="userid" th:if=" ${session.userservice} ne null"
                               th:value="${session.userservice.uid}"/>
                        <input type="hidden" id="username" th:if=" ${session.userservice} ne null"
                               th:value="${session.userservice.uname}"/>
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span th:if=" ${session.userservice} ne null" th:text="${session.userservice.uname}"></span>
                            <span th:if="${session.userservice} eq null " th:text="请登录"></span>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" th:if="${session.userservice} ne null" href="/loginup">
                                <span th:if="${session.userservice} ne null " th:text="注销"></span>
                            </a>
                            <a class="dropdown-item" th:if="${session.userservice} eq null " href="/">
                                <span th:if="${session.userservice} eq null " th:text="登录"></span>
                            </a>
                            <a href="#" class="dropdown-item" data-toggle="modal" data-target="#persionmessage"
                               role="button">查看个人信息</a>
                            <a href="#" class="dropdown-item" data-toggle="modal" data-target="#editmessage"
                               role="button">编辑个人信息</a>
                        </div>
                    </li>
                </ul>

            </div>
        </nav>
    </div>
</header>


<!--/banner-->

<br/>
<div id="team">
    <div class="container" >
        <div class="w3-head-all text-center mb-5">
            <h3>填写创建团队表</h3>
        </div>
        <el-form  :model="teamnew" ref="teamnew" status-icon :rules="rules" label-width="120px" label-height="200px" style="width: 600px">
            <el-form-item label="团队队长:">
                <span >{{teamnew.tduiz}}</span>
            </el-form-item>
            <el-form-item label="团队名称:" prop="tname">
                <el-input v-model="teamnew.tname" clearable></el-input>
            </el-form-item>
            <el-form-item label="团队介绍:" prop="siogans">
                <el-input type="textarea" v-model="teamnew.siogans" clearable></el-input>
            </el-form-item>
            <el-form-item label="团队码:" prop="code">
                <el-input v-model="teamnew.code" placeholder="请输入四位数字" clearable></el-input>
            </el-form-item>
            <el-form-item label="团队联系电话:" prop="tphone">
                <el-input v-model="teamnew.tphone" placeholder="" clearable></el-input>
            </el-form-item>
            <el-form-item label="团队联系邮箱:" prop="temail">
                <el-input v-model="teamnew.temail" placeholder="" clearable></el-input>
            </el-form-item>
            <el-form-item label="团队地址:" prop="taddress">
                <el-input v-model="teamnew.taddress" placeholder="" clearable></el-input>
            </el-form-item>
            <el-form-item label="团队服务范围:" prop="trange">
                <el-input v-model="teamnew.trange" placeholder="" clearable></el-input>
            </el-form-item>
            <br/>
            <el-form-item>
                <el-button type="primary" @click="onSubmit('teamnew')">立即创建</el-button>
                <el-button @click="resetForm('teamnew')">重置</el-button>
            </el-form-item>
        </el-form>

    </div>
</div>
<!-- //about -->
<!-- /pricing -->


</div>
<!-- //subscribe -->
<div class="footer-main">
    <div class="footer-social">
        <h4>关于平台</h4>
        <ul>
            <li>
                <span class="fab fa-facebook-f icon_facebook"></span>
                <p style="color: white;">服务范围为广东省广州市地区</p>
            </li>

        </ul>
    </div>
    <div class="cpy-right">
        <p>2020-3-5 《同城搬家供需信息交流平台》平台联系人：曾运棋 联系电话：12345678910</p>

    </div>
</div>
<!--//footer -->
<!-- Vertically centered Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-uppercase" id="exampleModalLongTitle">Estate Mark</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <img src="images/modal.jpg" class="img-fluid mb-4" alt="Modal Image"/>
                Vivamus eget est in odio tempor interdum. Mauris maximus fermentum arcu, ac finibus ante. Sed mattis
                risus at ipsum elementum, ut auctor turpis cursus. Sed sed odio pharetra, aliquet velit cursus, vehicula
                enim. Mauris porta aliquet magna, eget laoreet ligula.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal">Save changes</button>
            </div>
        </div>
    </div>
</div>
<!--
	作者：offline
	时间：2020-03-08
	描述：个人信息模态框 data-toggle="modal" data-target="#persionmessage"
-->
<div class="modal fade" id="persionmessage" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-uppercase" id="exampleModalLongTitle">我的信息</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div id="app" class="modal-body">
                <el-form ref="form" :model="form" label-width="80px">

                    <el-form-item label="姓名:">
                        <!--<el-input v-model="form.uname" :readonly="true" ></el-input>-->
                        <span>{{form.uname}}</span>
                    </el-form-item>
                    <el-form-item label="性别">

                        <el-radio-group v-model="form.sex" :readonly="true">
                            <el-radio label="1" :readonly="true">男</el-radio>
                            <el-radio label="2" :readonly="true">女</el-radio>
                        </el-radio-group>
                    </el-form-item>
                    <el-form-item label="身份证号">
                        <el-input v-model="form.identity" :readonly="true"></el-input>
                    </el-form-item>
                    <el-form-item label="邮箱">
                        <el-input v-model="form.email" :readonly="true"></el-input>
                    </el-form-item>
                    <el-form-item label="手机号码">

                        <el-input v-model="form.phone" :readonly="true"></el-input>
                    </el-form-item>
                    <el-form-item label="出生日期">

                        <el-input v-model="form.birthday" :readonly="true"></el-input>
                    </el-form-item>
                    <el-form-item label="个人说明">
                        <el-input v-model="form.signature" :readonly="true"></el-input>
                    </el-form-item>
                    <el-form-item label="住址">
                        <el-input v-model="form.address" :readonly="true"></el-input>
                    </el-form-item>
                    <el-form-item label="注册时间">
                        <el-input v-model="form.registrationtime" :readonly="true"></el-input>
                    </el-form-item>

                </el-form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>
<!--修改-->
<div class="modal fade" id="editmessage" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-uppercase" id="exampleModalLongTitle">编辑我的信息</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div id="ap" class="modal-body">
                <el-form ref="form" :model="editform" label-width="80px">

                    <el-form-item label="姓名">
                        <el-input v-model="editform.uname"></el-input>
                    </el-form-item>
                    <el-form-item label="性别">
                        <el-radio-group v-model="editform.sex">
                            <el-radio label="1">男</el-radio>
                            <el-radio label="2">女</el-radio>
                        </el-radio-group>
                    </el-form-item>
                    <el-form-item label="身份证号">
                        <el-input v-model="editform.identity"></el-input>
                    </el-form-item>
                    <el-form-item label="邮箱">
                        <el-input v-model="editform.email"></el-input>
                    </el-form-item>
                    <el-form-item label="手机号码">

                        <el-input v-model="editform.phone"></el-input>
                    </el-form-item>
                    <el-form-item label="出生日期">

                        <el-input v-model="editform.birthday"></el-input>
                    </el-form-item>
                    <el-form-item label="个人说明">
                        <el-input v-model="editform.signature"></el-input>
                    </el-form-item>
                    <el-form-item label="住址">
                        <el-input v-model="editform.address"></el-input>
                    </el-form-item>
                    <el-form-item label="注册时间">
                        <el-input v-model="editform.registrationtime"></el-input>
                    </el-form-item>

                    <div class="modal-footer">
                        <el-button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</el-button>
                        <el-button type="button" class="btn btn-primary" data-dismiss="modal">保存</el-button>
                    </div>
                </el-form>
            </div>
        </div>
    </div>
</div>
<!-- //Vertically centered Modal -->


<!-- js -->
<script type="text/javascript" src="/js/jquery-2.2.3.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.js"></script> <!-- Necessary-JavaScript-File-For-Bootstrap -->
<!-- //js -->
<!-- requried-jsfiles-for owl -->    <!-- testimonials -->
<script src="/js/owl.carousel.js"></script>
<script>
    $(document).ready(function () {
        $("#owl-demo2").owlCarousel({
            items: 1,
            lazyLoad: false,
            autoPlay: true,
            navigation: false,
            navigationText: false,
            pagination: true,
        });
    });
</script>
<!-- //requried-jsfiles-for owl -->    <!-- //testimonials -->
<!-- start-smooth-scrolling -->
<script src="/js/move-top.js"></script>
<script src="/js/easing.js"></script>

<!-- //end-smooth-scrolling -->

<!-- smooth-scrolling-of-move-up -->
<script>
    $(document).ready(function () {

        $().UItoTop({
            easingType: 'easeOutQuart'
        });

    });
</script>
<!-- //smooth-scrolling-of-move-up -->
<!-- smooth scrolling js -->
<script src="/js/SmoothScroll.min.js"></script>
<!-- //smooth scrolling js -->
<script>
    new Vue({
        el: '#app',
        data: function () {
            return {
                form: {},
            };
        },
        created() {
            const that = this;
            that.loan();

        },
        methods: {

            loan() {
                this.form = {
                    uaname: '曾运棋',
                    sex: '1',
                    email: '123@qq.com',
                    identity: '4565564',
                    phone: '12345648',
                    birthday: '2020-14-2',
                    signature: '你哈 ',
                    address: '广州',
                    registrationtime: '2020-02-30'
                };
            },
        }
    })
</script>
<script>
    new Vue({
        el: '#ap',
        data: function () {
            return {

                editform: {},
                postform: {},
            };
        },
        created() {
            const that = this;
            that.getform();
        },
        methods: {

            getform() {
//  	const that=this;
                this.editform = {
                    uaname: '曾运棋',
                    sex: '1',
                    email: '123@qq.com',
                    identity: '4565564',
                    phone: '12345648',
                    birthday: '2020-14-2',
                    signature: '你哈 ',
                    address: '广州',
                    registrationtime: '2020-02-30'
                };
            },
        }
//  methods: {
//    onSubmit() {
//      console.log('submit!');
//    }
//  }
    })
</script>
<script>
    var uname=$("#username").val();
    var uid=$("#userid").val();
    new Vue({
        el: '#team',
        data: function () {
            return {
                count:'',
                teamnew: {
                    tduiz:uname,
                    tname: '',
                    siogans: '',
                    code: '',
                    taddress: '',
                    trange: '',
                    tphone: '',
                    temail:''

                },
                rules: {
                    tname: [
                        { required: true, message: '请输入团队名', trigger: 'blur' },
                        // {
                        //     pattern: /^[\u4E00-\u9FA5]+$/,  //正则
                        //     message: '用户名只能为中文'
                        // }
//                      { min: 2, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }
//                      {pattern: ^[\\u4e00-\\u9fa5]{2,5}+$ , message: '用户名为2-5个中文',trigger: 'blur'}
                    ],
                    siogans: [
                        { required: true, message: '请输入团队介绍', trigger: 'blur' },
                        // { pattern: /^\d{6}$/, message: '请输入6位数字密码', trigger: 'blur' }
                    ],
                    code:  [
                        { required: true, message: '请输入团队码', trigger: 'blur' },
                        { pattern: /^\d{4}$/, message: '团队码只能是四位数字', trigger: 'blur' }
                    ],
                    temail: [
                        { type: 'email', required: true, message: '请输入团队联系邮箱', trigger: 'blur' },

                        {pattern: /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,
                            message: '邮箱格式不正确'
                        }
                    ],
                    tphone: [
                        {  required: true, message: '请输入团队联系手机号', trigger: 'blur' },

                        {pattern: /^((1[3-8][0-9])+\d{8})$/,
                            message: '手机号格式不正确'
                        }
                    ],

                    taddress: [
                        { required: true, message: '请输入团队所在地址', trigger: 'blur' }
                    ],
                    trange: [
                        { required: true, message: '请输入服务范围地址', trigger: 'blur' }

                    ],

                }
            };
        },
        created() {
            const that = this;
            getmymessage();
        },
        methods: {
            onSubmit(ruleF) {
          this.teamnew.uid=parseInt(uid);
                this.$refs[ruleF].validate((valid) => {
                    if (valid) {
                axios.post('/team/create', JSON.stringify(this.teamnew), {
                        headers: {
                            'Content-Type': 'application/json;charset=UTF-8'
                        }
                    }
                ).then(req => {
                    if(req.data.success==false){
                        this.$message({message: req.data.message, type: 'error'});// alert(req.data.message);
                        return false;
                    }
                    else{
                        this.$message({message: '创建成功！', type: 'success'});
                        this.goGrdoupRecor()

                    }


                })
                    } else {
                        this.$message({message: '请填写好信息！', type: 'error'});
                        return false;
                    }
                });
            },
            goGrdoupRecor(){
                const TIME_COUNT = 2;
                if(!this.timer){
                    this.count = TIME_COUNT;
                    this.show = false;
                    this.timer = setInterval(()=>{
                        if(this.count > 0 && this.count <= TIME_COUNT){
                            this.count--;
                        }else{
                            this.show = true;
                            clearInterval(this.timer);
                            this.timer = null;
                            this.teamnew={
                                tduiz:uname,
                                    tname: '',
                                    siogans: '',
                                    code: '',
                                    taddress: '',
                                    trange: '',
                                    tphone: '',
                                    temail:''

                            },
                                //跳转的页面写在此处
                                window.location.href="myteammessage";

                        }
                    },1000)
                }
            },
            resetForm(formName) {
                this.$refs[formName].resetFields();
            }

        }

    })
</script>
<style>
    .el-form-item {
        height: 50px;
    }
</style>
</body>
</html>
