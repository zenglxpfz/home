<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>About</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="keywords" content=""/>

    <script type="application/x-javascript">
        addEventListener("load", function () {
            setTimeout(hideURLbar, 0);
        }, false);

        function hideURLbar() {
            window.scrollTo(0, 1);
        }
    </script>
    <link rel="stylesheet" href="/css/bootstrap.css"> <!-- Bootstrap-Core-CSS -->
    <link href="/css/style.css" rel='stylesheet' type='text/css'/>
    <link href="/css/fontawesome-all.css" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Exo+2" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i"
          rel="stylesheet">
    <!--	描述：elm -->
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://cdn.staticfile.org/axios/0.18.0/axios.min.js"></script>
    <script src="base/plugins/jquery/jquery.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="/base/dist/css/adminlte.min.css">
    <link rel="stylesheet" href="/base/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
    <link rel="stylesheet" href="/css/common.css">
    <!--elm  -->
</head>

<body>
<header>
    <div class="header">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="index.html">同城搬家供需信息交流平台</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item ">
                        <a class="nav-link" href="/userservice/main">首页<span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/u/order">我的团队订单</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="/myteammessage">我的团队信息</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/u/contact">我的团队消息</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="/u/myliuyan">我的消息</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="/forteam/notice">告示</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span th:if=" ${session.userservice} ne null" th:text="${session.userservice.uname}"></span>
                            <span th:if="${session.userservice} eq null " th:text="请登录"></span>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" th:if="${session.userservice} ne null" href="/loginup">
                                <span th:if="${session.userservice} ne null " th:text="注销"></span>
                            </a>
                            <a class="dropdown-item" th:if="${session.userservice} eq null " href="/">
                                <span th:if="${session.userservice} eq null " th:text="登录"></span>
                            </a>
                            <a href="#" class="dropdown-item" data-toggle="modal" data-target="#exampleModalCenter"
                               role="button">查看个人信息</a>
                            <a href="#" class="dropdown-item" data-toggle="modal" data-target="#addresources"
                               role="button">编辑个人信息</a>
                        </div>
                    </li>
                </ul>

            </div>
        </nav>
    </div>
</header>
<div id="teammessages" th:if="${session.userservice.code} ne '0' ">
    <input type="hidden" th:if="${session.team ne null}" th:value="${session.team.code}" id="code" name="code"/>
    <input type="hidden" th:if="${session.team ne null}" th:value="${session.team.tid}" id="tid1" name="tid1"/>
    <input type="hidden" th:if="${session.team ne null}" th:value="${session.team.tname}" id="tname" name="tname"/>

    <input type="hidden" th:value="${session.userservice.uid}" id="uid" name="uid"/>

    <div class="statistics py-5">
        <div class="container">
            <div class="w3-head-all text-center mb-5">
                <h3>{{teammessage.tname}}团队的信息</h3>
            </div>
            <div class="row">
                <div class="col-md-12" style="height: 700px; width: 100%; ">

                    <br/>
                    <h5 style="text-align: center; color: blue;">团队基本信息</h5>
                    <el-form ref="form" :model="teammessage" label-width="120px">

                        <el-row>
                            <el-col :span="10">
                                <el-form-item label="团队名称：">
                                    <span>{{teammessage.tname}}</span>
                                </el-form-item>
                            </el-col>
                            <el-col :span="10">
                                <el-form-item label="团队队长：">
                                    <span>{{teammessage.tduiz}}</span>
                                </el-form-item>
                            </el-col>
                        </el-row>
                        <el-row>
                            <el-col :span="10">
                                <el-form-item label="团队人数：">
                                    <span>{{teammessage.tperson}}</span>
                                </el-form-item>
                            </el-col>
                            <el-col :span="10">
                                <el-form-item label="团队服务范围：">
                                    <span>{{teammessage.trange}}</span>
                                </el-form-item>
                            </el-col>
                        </el-row>
                        <el-row>
                            <el-col :span="10">
                                <el-form-item label="团队联系电话：">
                                    <span>{{teammessage.tphone}}</span>
                                </el-form-item>
                            </el-col>
                            <el-col :span="10">
                                <el-form-item label="团队地址：">
                                    <span>{{teammessage.taddress}}</span>
                                </el-form-item>
                            </el-col>
                        </el-row>
                        <el-row>
                            <el-col :span="10">
                                <el-form-item label="团队订单量：">
                                    <span>{{teammessage.orders}}</span>
                                </el-form-item>
                            </el-col>
                            <el-col :span="10">
                                <el-form-item label="团队码：">
                                    <span>{{teammessage.code}}</span>
                                </el-form-item>
                            </el-col>
                        </el-row>
                        <el-row>
                            <el-col :span="10">
                                <el-form-item label="团队成立时间：">
                                    <span>{{teammessage.createtime}}</span>
                                </el-form-item>
                            </el-col>
                            <el-col :span="10">
                                <el-form-item label="团队联系邮箱：">

                                    <span>{{teammessage.temail}}</span>
                                </el-form-item>
                            </el-col>
                        </el-row>
                        <!--                        <el-row>-->
                        <!--                            <el-col :span="10">-->
                        <!--                                <el-form-item label="团队荣誉：">-->
                        <!--                                    <span>{{teammessage.thonor}}</span>-->
                        <!--                                </el-form-item>-->
                        <!--                            </el-col>-->
                        <!--                            <el-col :span="10">-->
                        <!--                                &lt;!&ndash;<el-form-item label="团队浏览量：">&ndash;&gt;-->
                        <!--                                    &lt;!&ndash;<span>{{teammessage.twatch}}</span>&ndash;&gt;-->
                        <!--                                &lt;!&ndash;</el-form-item>&ndash;&gt;-->
                        <!--                            </el-col>-->
                        <!--                        </el-row>-->
                        <el-row>
<!--                            <el-col :span="10">-->
<!--                                -->
                                <el-form-item label="团队介绍：">
                                    <span>{{teammessage.siogans}}</span>
                                </el-form-item>
<!--                            </el-col>-->
<!--                            <el-col :span="10">-->
<!--                                &lt;!&ndash;<el-form-item label="团队图片：">&ndash;&gt;-->
<!--                                &lt;!&ndash;<span>{{teammessage.picture}}</span>&ndash;&gt;-->
<!--                                &lt;!&ndash;</el-form-item>&ndash;&gt;-->
<!--                            </el-col>-->
                        </el-row>

                        <el-row>
                            <el-button type="text" @click="dialogTableVisible = true">查看所有成员</el-button>
                            <el-button type="text" @click="table = true">添加成员</el-button>

                            <el-button type="text" @click="editteam=true" role="button">修改信息
                            </el-button>

                        </el-row>
                    </el-form>
                    <el-dialog title="成员列表" :visible.sync="dialogTableVisible">
                        <el-table :data="duiyuan">
                            <el-table-column
                                    type="index"
                                    label="序号"
                                    width="50">
                            </el-table-column>
                            <el-table-column property="uname" label="姓名" width="120"></el-table-column>
                            <el-table-column property="phone" label="联系方式" width="120"></el-table-column>
                            <el-table-column property="role" label="团队角色"></el-table-column>
                            <el-table-column label="操作">
                                <template slot-scope="scope">
                                    <el-button type="text" @click="delectchengyuan(scope.row)">删除</el-button>

                                </template>
                            </el-table-column>
                        </el-table>
                    </el-dialog>

                    <el-drawer
                            title="来这里邀请用户作为队员吧!"
                            :visible.sync="table"
                            direction="rtl"
                            size="40%">

                        <div>
                            <el-form ref="form" :model="sou" class="form-inline my-2 my-lg-0">
                                <el-form-item label="">
                                    <el-input v-model="sou.tname" placeholder="请输入信息查询用户"
                                              aria-label="Search"></el-input>
                                </el-form-item>
                            </el-form>
                            <el-button @click="sousuo" class="btn btn-outline-success my-2 my-sm-0">Search</el-button>
                        </div>
                        <el-table :data="chengyuan">
                            <el-table-column type="index" label="序号" width="100"></el-table-column>
                            <el-table-column property="uname" label="姓名" width="150"></el-table-column>
                            <el-table-column property="phone" label="手机号" width="200"></el-table-column>
                            <el-table-column label="操作">
                                <template slot-scope="scope">
                                    <el-button type="text" @click="add(scope.row)">邀请</el-button>
                                </template>
                            </el-table-column>
                        </el-table>
                    </el-drawer>

                    <el-dialog title="添加服务内容" :visible.sync="dialogVisible">
                        <el-form :model="cadd" ref="cadd" status-icon :rules="ruless">
                            <el-form-item label="团队名称:">
                                <el-input realonly v-model="cadd.tname" :readonly="true" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="团队id:">
                                <el-input realonly v-model="cadd.tid" :readonly="true" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="服务内容规则:">
                                <el-input type="textarea" v-model="cadd.crules" clearable></el-input>
                            </el-form-item>
                        </el-form>
                        <div slot="footer" class="dialog-footer">
                            <el-button @click="dialogVisible = false">取 消</el-button>
                            <el-button type="primary" @click="addsss('cadd')">确 定</el-button>
                        </div>

                    </el-dialog>
                    <el-dialog title="修改服务内容" :visible.sync="disruleform">
                        <el-form :model="cadd">
                            <el-form-item label="团队名称:">
                                <el-input realonly v-model="cadd.tname" :readonly="true" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="团队id:">
                                <el-input realonly v-model="cadd.tid" :readonly="true" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="服务内容规则:">
                                <el-input type="textarea" v-model="cadd.crules" clearable></el-input>
                            </el-form-item>
                        </el-form>
                        <div slot="footer" class="dialog-footer">
                            <el-button @click="disruleform = false">取 消</el-button>
                            <el-button type="primary" @click="reidts">确 定</el-button>
                        </div>

                    </el-dialog>


                    <el-dialog title="添加资源" :visible.sync="editrule">
                        <el-form :model="radd" ref="radd" status-icon :rules="rules">
                            <el-form-item label="团队名称:">
                                <el-input v-model="radd.tname" :readonly="true" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="团队id:">
                                <el-input v-model="radd.tid" :readonly="true" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="资源名称:">
                                <el-input type="text" v-model="radd.rname" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="资源描述:">
                                <el-input type="text" v-model="radd.rdescription" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="资源数量:">
                                <el-input type="text" v-model="radd.rquantity" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="购入时间:">
                                <el-date-picker
                                        v-model="radd.buytime"
                                        placeholder="选择购入时间"
                                        type="date"
                                        format="yyyy年MM月dd日"
                                        value-format="yyyy-MM-dd"
                                        style="padding: 20px 0"
                                >
                                </el-date-picker>
                            </el-form-item>
                            <el-form-item label="有效期:">
                                <el-input type="text" v-model="radd.validity" clearable></el-input>
                            </el-form-item>
                            <!--<el-form-item label="资源图片:">-->
                            <!--<el-input type="text" v-model="radd.picture" clearable></el-input>-->
                            <!--</el-form-item>-->
                        </el-form>
                        <div slot="footer" class="dialog-footer">
                            <el-button @click="editrule = false">取 消</el-button>
                            <el-button type="primary" @click="asubmit('radd')">确 定</el-button>
                        </div>
                    </el-dialog>
                    <el-dialog title="修改资源" :visible.sync="editres">
                        <el-form :model="radd">
                            <el-form-item label="团队名称:">
                                <el-input v-model="radd.tname" :readonly="true" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="团队id:">
                                <el-input v-model="radd.tid" :readonly="true" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="资源名称:">
                                <el-input type="text" v-model="radd.rname" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="资源描述:">
                                <el-input type="text" v-model="radd.rdescription" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="资源数量:">
                                <el-input type="text" v-model="radd.rquantity" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="购入时间:">
                                <el-date-picker
                                        v-model="radd.buytime"
                                        placeholder="选择购入时间"
                                        type="date"
                                        format="yyyy年MM月dd日"
                                        value-format="yyyy-MM-dd">
                                    >
                                </el-date-picker>
                            </el-form-item>
                            <el-form-item label="有效期:">
                                <el-input type="text" v-model="radd.validity" clearable></el-input>
                            </el-form-item>
                            <!--<el-form-item label="资源图片:">-->
                            <!--<el-input type="text" v-model="radd.picture" clearable></el-input>-->
                            <!--</el-form-item>-->
                        </el-form>
                        <div slot="footer" class="dialog-footer">
                            <el-button @click="editres = false">取 消</el-button>
                            <el-button type="primary" @click="reidtss">确 定</el-button>
                        </div>

                    </el-dialog>
                    <el-dialog title="修改团队信息" :visible.sync="editteam">
                        <el-form :model="editmessage">
                            <el-form-item label="团队队长:">
                                <span>{{editmessage.tduiz}}</span>
                            </el-form-item>
                            <el-form-item label="团队名称:">
                                <el-input v-model="editmessage.tname" clearable></el-input>
                            </el-form-item>

                            <!--<el-form-item label="团队码:">
                                <el-input v-model="editmessage.code" placeholder="请输入四位数字" maxlength="4"
        show-word-limit clearable></el-input>
                            </el-form-item>-->
                            <el-form-item label="团队联系电话:">
                                <el-input v-model="editmessage.tphone" placeholder="" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="团队地址:">
                                <el-input v-model="editmessage.taddress" placeholder="" clearable></el-input>
                            </el-form-item>
                            <el-form-item label="团队服务范围:">
                                <el-input v-model="editmessage.trange" placeholder="" clearable> sddfsdfs</el-input>
                            </el-form-item>
                            <el-form-item label="团队介绍:">
                                <el-input type="textarea" v-model="editmessage.siogans" clearable></el-input>
                            </el-form-item>
                        </el-form>
                        <div slot="footer" class="dialog-footer">
                            <el-button @click="editteam = false">取 消</el-button>
                            <el-button type="primary" @click="submitteam">保 存</el-button>
                        </div>

                    </el-dialog>
                </div>
            </div>
            <hr color="#0069D9"/>
            <div class="row">
                <div class="col-md-12" style="height: 500px; width: 100%; ">
                    <br/>
                    <h5 style="text-align: center; color: blue;">团队规则</h5>
                    <div>
                        <el-button type="text" @click="dialogVisible = true" role="button"> 新增规则
                        </el-button>
                    </div>
                    <el-table
                            :data="rule"
                            height="400"
                            style="width: 100%">
                        <el-table-column
                                type="index"
                                label="序号"
                                width="120">
                        </el-table-column>
                        <el-table-column

                                prop="crules"
                                label="服务内容规则"
                                width="200">
                        </el-table-column>
                        <el-table-column

                                prop="createtime"
                                label="创建时间"
                                width="200">
                        </el-table-column>
                        <el-table-column label="操作">
                            <template slot-scope="scope">
                                <el-button type="text" @click="ceidt(scope.row)">编辑</el-button>

                                <el-button type="text" @click="cdelect(scope.row)">删除</el-button>
                            </template>
                        </el-table-column>
                    </el-table>
                </div>

            </div>
            <hr color="#0069D9"/>
            <div class="row">
                <div class="col-md-12" style="height: 500px; width: 100%;  ">

                    <br/>
                    <h5 style="text-align: center; color: blue;">团队资源</h5>
                    <div>
                        <el-button type="text" @click="editrule=true" role="button"> 新增资源
                        </el-button>
                    </div>

                    <el-table
                            :data="resources"
                            height="400"
                            style="width: 100%">
                        <el-table-column
                                type="index"
                                label="序号"
                                width="120">
                        </el-table-column>
                        <el-table-column
                                prop="rname"
                                label="资源名称"
                                width="120">
                        </el-table-column>
                        <el-table-column
                                prop="rdescription"
                                label="资源描述"
                                width="180">
                        </el-table-column>
                        <el-table-column
                                prop="rquantity"
                                label="资源数量"
                                width="120"
                        >
                        </el-table-column>
                        <el-table-column
                                prop="buytime"
                                label="购入时间"
                                width="120"
                        >
                        </el-table-column>
                        <el-table-column
                                prop="validity"
                                label="有效期"
                                width="120"
                        >
                        </el-table-column>
                        <!--                        <el-table-column-->
                        <!--                                prop="picture"-->
                        <!--                                label="资源图片">-->
                        <!--                        </el-table-column>-->
                        <el-table-column label="操作">
                            <template slot-scope="scope">
                                <el-button type="text" @click="reidt(scope.row)">编辑</el-button>

                                <el-button type="text" @click="rdelect(scope.row)">删除</el-button>
                            </template>
                        </el-table-column>
                    </el-table>

                </div>
            </div>
            <hr color="#0069D9"/>
        </div>

    </div>

</div>
</div>
<div style="height: 600px" th:if="${session.userservice.code }eq '0'">

    <h5>
        <a href="/userservice/main">还没有团队，去创建或者加入团队吧！</a>
    </h5>
</div>
<div class="footer-main">
    <div class="footer-social">
        <h4>关于平台</h4>
        <ul>
            <li>

                <span class="fab fa-facebook-f icon_facebook"></span>
                <p style="color: white;">服务范围为广东省广州市地区</p>

            </li>

        </ul>
    </div>
    <div class="cpy-right">
        <p>2020-3-5 《同城搬家供需信息交流平台》平台联系人：曾运棋 联系电话：12345678910</p>
    </div>
</div>
<!-- //footer -->

<!--修改-->
<div class="modal fade" id="editteams" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-uppercase" id="exampleModalLongTitle">编辑我的团队信息</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true"></span>
                </button>
            </div>
            <div class="modal-body">
                <div id="app">
                    <el-form ref="form" :model="editmessage" label-width="120px">
                        <el-form-item label="团队队长:">
                            <span>{{editmessage.tduiz}}</span>
                        </el-form-item>
                        <el-form-item label="团队名称:">
                            <el-input v-model="editmessage.tname" clearable></el-input>
                        </el-form-item>
                        <el-form-item label="团队介绍:">
                            <el-input type="textarea" v-model="editmessage.siogans" clearable></el-input>
                        </el-form-item>
                        <!--<el-form-item label="团队码:">
                            <el-input v-model="editmessage.code" placeholder="请输入四位数字" maxlength="4"
    show-word-limit clearable></el-input>
                        </el-form-item>-->
                        <el-form-item label="团队联系电话:">
                            <el-input v-model="editmessage.tphone" placeholder="" clearable></el-input>
                        </el-form-item>
                        <el-form-item label="团队地址:">
                            <el-input v-model="editmessage.taddress" placeholder="" clearable></el-input>
                        </el-form-item>
                        <el-form-item label="团队服务范围:">
                            <el-input v-model="editmessage.trange" placeholder="" clearable> sddfsdfs</el-input>
                        </el-form-item>

                        <div class="modal-footer">
                            <el-button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</el-button>
                            <el-button @click="submitteam">保存</el-button>
                        </div>
                    </el-form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- odometer-script -->
<script src="/js/odometer.js"></script>
<script>
    window.odometerOptions = {
        format: '(ddd).dd'
    };
</script>
<script>
    setTimeout(function () {
        jQuery('#w3l_stats1').html(25);
    }, 1500);
</script>
<script>
    setTimeout(function () {
        jQuery('#w3l_stats2').html(330);
    }, 1500);
</script>
<script>
    setTimeout(function () {
        jQuery('#w3l_stats3').html(542);
    }, 1500);
</script>
<!-- //odometer-script -->

<!-- js -->
<script type="text/javascript" src="/js/jquery-2.2.3.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.js"></script> <!-- Necessary-JavaScript-File-For-Bootstrap -->
<!-- //js -->
<!-- start-smooth-scrolling -->
<script src="/js/move-top.js"></script>
<script src="/js/easing.js"></script>
<script>
    jQuery(document).ready(function ($) {
        $(".scroll").click(function (event) {
            event.preventDefault();
            $('html,body').animate({
                scrollTop: $(this.hash).offset().top
            }, 1000);
        });
    });
</script>
<!-- //end-smooth-scrolling -->

<!-- smooth-scrolling-of-move-up -->
<script>
    $(document).ready(function () {
        $().UItoTop({
            easingType: 'easeOutQuart'
        });

    });
</script>
<!-- //smooth-scrolling-of-move-up -->


<!-- smooth scrolling js -->
<script src="/js/SmoothScroll.min.js"></script>
<!-- //smooth scrolling js -->

<script>
    new Vue({
        el: '#app',
        data: function () {
            return {
                // editmessage: {
                //     tid: tid,
                //     tname: tname,
                //     siogans: '',
                //     code: '',
                //     createtime: '',
                //     status: '',
                //     tpicture: '',
                //     thonor: '',
                //     taddress: '',
                //     trange: ''
                // },
                addmessage: {
                    content: '',
                    uid: ''
                },
            };
        },
        created() {
            const that = this;
        },
        methods: {
            //编辑团队信息
            // submitteam() {
            //     axios.post('/team/edit', JSON.stringify(this.teammessage), {
            //             headers: {
            //                 'Content-Type': 'application/json;charset=UTF-8'
            //             }
            //         }
            //     ).then(req => {
            //
            //
            //         alert("保存成功！");
            //         this.oneteam();
            //     })
            // },


        },

    })
</script>
<!--
	作者：offline
	时间：2020-03-09
	描述：查看团队信息列表包括志愿表和规则表
-->
<script>
    var tname = $("#tname").val();
    //var code = $("#code").val();
    var uid = $("#uid").val();
    var tid1= $("#tid1").val();
    new Vue({
        el: '#teammessages',
        data: function () {
            return {
                sou: {
                    tname: ''
                },
                editrule: false,
                dialogVisible: false,
                disruleform: false,
                editres: false,
                editteam: false,
                teammessage: {},
                resources: [],
                rule: [],
                // liuyan: [],
                // addmessage: {
                //     content: '',
                //     uid: ''
                // },
                duiyuan: [],
                //保存留言信息
                //	getmessage: [],
                dialogTableVisible: false,
                table: false,
                chengyuan: [],
                //规则
                cadd: {
                    cid: '',
                    crules: '',
                    tid: tid1,
                    tname: tname

                },
                //资源
                radd: {
                    rid: '',
                    tid: tid1,
                    rname: '',
                    rdescription: '',
                    rquantity: '',
                    buytime: '',
                    validity: '',
                    tname: tname

                },
                editmessage: {
                    tid: tid1,
                    tname: tname,
                    siogans: '',
                    code: '',
                    createtime: '',
                    status: '',
                    tpicture: '',
                    thonor: '',
                    taddress: '',
                    trange: ''
                },
                rules: {
                    rname: [
                        {required: true, message: '请输入资源名称', trigger: 'blur'}
                    ],
                    rdescription: [
                        {required: true, message: '请输入资源描述', trigger: 'blur'}
                    ],
                    rquantity: [
                        {required: true, message: '请输入资源数量', trigger: 'blur'}
                    ],
                    buytime: [
                        {required: true, message: '请输入资源购入时间', trigger: 'blur'}
                    ],
                    validity: [
                        {required: true, message: '请输入资源有效期', trigger: 'blur'}
                    ],

                },
                ruless: {
                    crules: [
                        {required: true, message: '请输入服务规则', trigger: 'blur'}
                    ],
                }

            };
        },
        created() {
            const that = this;
            that.oneteam();
            that.getliuyan();
            that.chengyuans();
            // that.addsss();
        },
        methods: {
            submit() {
                const that = this;
                this.addmessage.uid = uid;
                this.addmessage.tid = tid1;
                axios.post('/mes/add',
                    JSON.stringify(this.addmessage), {
                        headers: {
                            'Content-Type': 'application/json;charset=UTF-8'
                        }
                    }).then(req => {
                    // alert("发布成功！！");
                    this.$message({message: '发布成功！！', type: 'success'});
                    this.addmessage.content = null;
                    this.liuyan = req.data.data;
                })
            },
            oneteam() {
                const that = this;
                axios.get('/team/orderteams', {
                    params: {
                        tid: tid1,
                        uid: uid
                    }
                }).then(req => {
                    this.teammessage = req.data.data;
                    this.resources = req.data.data.resoucesDTOS;
                    this.rule = req.data.data.contentDTOS;
                    this.duiyuan = req.data.data.userserviceDTOs;
                    this.editmessage = req.data.data;

                })
            },
            getliuyan() {
                var x = {
                    tid: tid1,
                    uid: uid
                }
                const that = this;
                axios.post('/mes/selectour', JSON.stringify(x), {
                        headers: {
                            'Content-Type': 'application/json;charset=UTF-8'
                        }
                    }
                ).then(req => {
                    this.liuyan = req.data.data;
                })
            },


            //邀请成员,发送请求
            add(a) {
                var x = {
                    uname: a.uname,
                    tname: this.teammessage.tname,
                    type: "0"
                }
                axios.post('/apply/add', JSON.stringify(x), {
                        headers: {
                            'Content-Type': 'application/json;charset=UTF-8'
                        }
                    }
                ).then(req => {
                    console.log(req.data);
                    if (req.data.code == "0") {
                        //alert(req.data.message);
                        this.$message({message: req.data.message, type: 'error'});
                        return false;
                    }

                    this.$message({message: '发送邀请成功！', type: 'success'});
                })
            },
            //删除成员
            delectchengyuan(a) {
                var duserid = a.uid;
                axios.get('/team/delchengyuan', {
                        params: {
                            tid: tid1,
                            uid: duserid
                        },
                    }
                ).then(req => {

                    if (req.data.success == true) {
                        this.$message({message: '删除成功！', type: 'success'});
                        this.oneteam();

                    }
                })
            },


            //查询所有用户
            chengyuans() {
                axios.get('/userservice/selectNullCode'
                ).then(req => {
                    this.chengyuan = req.data.data;


                })
            },
            addsss(ruleF) {
                //添加规则
                this.cadd.tid = this.teammessage.tid;
                this.$refs[ruleF].validate((valid) => {
                    if (valid) {
                        axios.post('/content/add', JSON.stringify(this.cadd), {
                                headers: {
                                    'Content-Type': 'application/json;charset=UTF-8'
                                }
                            }
                        ).then(req => {
                            this.$message({message: '添加规则成功！', type: 'success'});
                            this.dialogVisible = false;
                            //刷新页面
                            this.cadd = {
                                cid: '',
                                crules: '',
                                tid: tid1,
                                tname: tname

                            };
                            this.oneteam();
                        })
                    } else {
                        this.$message({message: '请填写好信息！', type: 'error'});
                        return false;
                    }
                });

            },
            //编辑规则
            ceidt(row) {

                this.cadd = row;
                this.cadd.tname = tname;
                this.disruleform = true;
            },
            reidts() {

                axios.post('/content/edit', JSON.stringify(this.cadd), {
                        headers: {
                            'Content-Type': 'application/json;charset=UTF-8'
                        }
                    }
                ).then(req => {

                    this.$message({message: '修改成功！', type: 'success'});
                    this.disruleform = false;
                    //刷新页面
                    this.cadd = {
                        cid: '',
                        crules: '',
                        tid: tid1,
                        tname: tname
                    };
                    this.oneteam();
                })

            },
            cdelect(row) {
                var x = {
                    cid: row.cid
                }
                axios.post('/content/del', JSON.stringify(x), {
                        headers: {
                            'Content-Type': 'application/json;charset=UTF-8'
                        }
                    }
                ).then(req => {

                    this.$message({message: '删除规则成功！', type: 'success'});
                    //刷新页面
                    this.oneteam();
                })
            },
            //资源
            asubmit(ruleF) {
                this.radd.tid = this.teammessage.tid;
                this.$refs[ruleF].validate((valid) => {
                    if (valid) {
                        axios.post('/resouces/create', JSON.stringify(this.radd), {
                                headers: {
                                    'Content-Type': 'application/json;charset=UTF-8'
                                }
                            }
                        ).then(req => {
                            this.$message({message: '添加资源成功！', type: 'success'});
                            this.editrule = false;
                            //刷新页面
                            this.radd = {
                                rid: '',
                                tid: tid1,
                                rname: '',
                                rdescription: '',
                                rquantity: '',
                                buytime: '',
                                validity: '',
                                tname: tname
                            };
                            this.oneteam();
                        })
                    } else {
                        this.$message({message: '请填写好信息！', type: 'error'});
                        return false;
                    }
                });
            },
            reidt(a) {
                this.radd = a;
                this.radd.tname = tname;
                this.editres = true;
            },
            reidtss() {
                axios.post('/resouces/edit', JSON.stringify(this.radd), {
                        headers: {
                            'Content-Type': 'application/json;charset=UTF-8'
                        }
                    }
                ).then(req => {

                    this.$message({message: '修改成功！', type: 'success'});
                    this.editres = false;
                    //刷新页面
                    this.radd = {
                        rid: '',
                        tid: tid1,
                        rname: '',
                        rdescription: '',
                        rquantity: '',
                        buytime: '',
                        validity: '',
                        tname: tname

                    };
                    this.oneteam();
                })
            },
            rdelect(row) {
                var x = {
                    rid: row.rid
                }
                axios.post('/resouces/del', JSON.stringify(x), {
                    headers: {
                        'Content-Type': 'application/json;charset=UTF-8'

                    }
                }).then(req => {
                    this.$message({message: '删除资源成功！', type: 'success'});
                    //刷新页面-->
                    this.oneteam();
                })
            },
            submitteam() {
                axios.post('/team/edit', JSON.stringify(this.editmessage), {
                        headers: {
                            'Content-Type': 'application/json;charset=UTF-8'
                        }
                    }
                ).then(req => {

                    this.$message({message: '修改成功！', type: 'success'});
                    this.editteam = false;
                    this.oneteam();
                })
            },
            sousuo() {
                axios.post('/userservice/selectbykey', JSON.stringify(this.sou), {
                        headers: {
                            'Content-Type': 'application/json;charset=UTF-8'
                        }
                    }
                ).then(req => {
                    this.chengyuan = req.data.data;
                    this.sou.tname = '';
                })
            },
        }
    })
</script>
<style>
    .el-form-item {
        height: 50px;
    }
</style>
</body>
</html>
