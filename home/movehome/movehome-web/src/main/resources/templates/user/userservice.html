<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" >

<head>
	<title>注册页面</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="utf-8">
	<meta name="keywords" content="" />

	<script type="application/x-javascript">
		addEventListener("load", function () {
			setTimeout(hideURLbar, 0);
		}, false);

		function hideURLbar() {
			window.scrollTo(0, 1);
		}
	</script>
	<link rel="stylesheet" href="/css/bootstrap.css"> <!-- Bootstrap-Core-CSS -->
	<link href="/css/style.css" rel='stylesheet' type='text/css' />
	<link href="/css/fontawesome-all.css" rel="stylesheet">
	<link href="http://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i" rel="stylesheet">
	<link href="http://fonts.googleapis.com/css?family=Raleway:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <!--	描述：elm -->
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://cdn.staticfile.org/axios/0.18.0/axios.min.js"></script>

    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="base/dist/css/adminlte.min.css">
    <link rel="stylesheet" href="base/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
    <!--elm  -->
</head>

<body>
<header>
	<div class="header">
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
		  <a class="navbar-brand" href="/">《同城搬家供需信息交流平台》提供服务用户注册</a>
		  </nav>
		</div>
</header>
	 <!-- Typography-->
<section class="inner-pages py-5">
        <div id="useradd" class="container py-xl-5 py-sm-3">
           <div class="w3-head-all text-center mb-3">
			<h3>填写注册信息</h3>
		   </div>
            <!-- forms -->
            <div>
                <el-form  :model="ruleForm" ref="ruleForm" status-icon :rules="rules"  label-width="100px" class="demo-ruleForm">
                    <el-form-item label="用户名" prop="uname">
                        <el-input v-model="ruleForm.uname" ></el-input>
                    </el-form-item>
                    <el-form-item label="密码" prop="password">
                        <el-input type="password" v-model="ruleForm.password"></el-input>
                    </el-form-item>
                    <el-form-item label="性别" prop="sex">
                        <el-radio-group v-model="ruleForm.sex">
                            <el-radio label="男"></el-radio>
                            <el-radio label="女"></el-radio>
                        </el-radio-group>
                    </el-form-item>
                    <el-form-item label="身份证号" prop="identity">
                        <el-input v-model="ruleForm.identity"></el-input>
                    </el-form-item>
                    <el-form-item label="邮箱" prop="email" autocomplete="off">
                        <el-input v-model="ruleForm.email"></el-input>
                    </el-form-item>
                    <el-form-item label="手机号码" prop="phone">
                        <el-input v-model="ruleForm.phone"></el-input>
                    </el-form-item>
                    <el-form-item label="出生日期" prop="birthday">
                        <!--<el-date-picker-->
                                <!--v-model="ruleForm.birthday"-->
                                <!--type="date"-->
                                <!--placeholder="选择日期">-->
                        <!--</el-date-picker>-->
                        <el-date-picker
                                v-model="ruleForm.birthday"
                                type="date"
                                placeholder="选择出生日期"
                                format="yyyy-MM-dd"
                                value-format="yyyy-MM-dd">
                        </el-date-picker>
                    </el-form-item>
                    <el-form-item label="住址" prop="address">
                        <el-input v-model="ruleForm.address"></el-input>
                    </el-form-item>
                    <el-form-item label="个人说明" >
                        <el-input v-model="ruleForm.signature"></el-input>
                    </el-form-item>

                    <el-form-item>
                        <el-button type="primary" @click="submitForm('ruleForm')">立即注册</el-button>
                        <el-button @click="resetForm('ruleForm')">重置</el-button>
                    </el-form-item>
                </el-form>
            </div>
 <!--<form style="width: 50%;" action="/adduserservice" method="post" enctype="multipart/form-data" >
  <div class="form-group">
    <label for="uname" style="font-size: 25px;">用户名:</label>
    <input type="text"  style="height: 50px;" class="form-control"name="uname" id="uname" />
  </div>
  <div class="form-group">
    <label for="password" style="font-size: 25px; ">密码:</label>
    <input type="password" style="height: 50px;" class="form-control" name="password" id="password" />
  </div>
  <div class="form-group">
    <label for="sex" style="font-size: 25px;">性别:</label>
	男：<input type="radio"    style="font-size: 25px;width: 50px"name="sex" id="sex" value="男" />
     女：<input type="radio" style="font-size: 25px;width: 50px"name="sex" id="sex1" value="女" />
  </div>
  <div class="form-group">
    <label for="email" style="font-size: 25px;">邮箱:</label>
    <input type="email" style="height: 50px;" class="form-control" name="email" id="email" />
  </div>
  <div class="form-group">
    <label for="identity" style="font-size: 25px;">身份证号:</label>
    <input type="text"style="height: 50px;" class="form-control" name="identity" id="identity" />
  </div>
  <div class="form-group" >
    <label for="phone" style="font-size: 25px;">手机号:</label>
    <input type="text"style="height: 50px;" class="form-control" name="phone" id="phone" />
  </div>
  <div class="form-group">
    <label for="birthday"style="font-size: 25px;">出生日期:</label>
    <input type="date"style="height: 50px;" class="form-control" name="birthday" id="birthday" />
  </div>
  <div class="form-group">
    <label for="signature"style="font-size: 25px;">个人说明:</label>
    <input type="text"style="height: 120px;" class="form-control" name="signature" id="signature" />
  </div>

  <div class="form-group">
    <label for="address"style="font-size: 25px;">住址:</label>
    <input type="text"style="height: 50px;" class="form-control" name="address" id="address" />
  </div>
 <div class="form-group">
    <label for="file" style="font-size: 25px;">上传证明图片：</label>
    <input style="height: 50px;" type="file" id="file" name="file">
  
  </div>
  <button type="submit" style="font-size: 25px;" class="btn btn-default" >提交</button>
  <button type="reset" class="btn btn-default" style="font-size: 25px;" >重新填写</button>
</form>
</div>
        -->
 </div>
</section>
<!-- subscribe -->
	<div class="footer-main">
		<div class="footer-social">
			<h4>关于平台</h4>
			<ul>
				<li>					
				<span class="fab fa-facebook-f icon_facebook"></span><p style="color: white;">服务范围为广东省广州市地区</p>					
				</li>
			</ul>
		</div>
		<div class="cpy-right">
			<p>2020-3-5 《同城搬家供需信息交流平台》平台联系人：曾运棋  联系电话：12345678910</p>
		</div>
    </div>


<!-- js -->
	<script type="text/javascript" src="/js/jquery-2.2.3.min.js"></script>
	<script type="text/javascript" src="/js/bootstrap.js"></script>
	<!-- //js -->
<!-- start-smooth-scrolling -->
	<script src="/js/move-top.js"></script>
	<script src="/js/easing.js"></script>

	<script src="/js/SmoothScroll.min.js"></script>
	<!-- //smooth scrolling js -->
<!--<script>-->

	<!--$("document").ready(function () {-->
		<!--$("#btn").click(function () {-->
			<!--var formData = new formData();-->
			<!--formData.append("picture",document.getElementById("picture").files(0));-->
			<!---->
			<!--var uname = $("#uname").val();-->
			<!--var password = $("#password").val();-->
			<!--var sex = $("#sex").val();-->
			<!--var email = $("#email").val();-->
			<!--var identity = $("#identity").val();-->
			<!--var phone = $("#phone").val();-->
			<!--var birthday = $("#birthday").val();-->
			<!--var signature = $("#signature").val();-->
			<!--var address = $("#address").val();-->


			<!--console.log("附加时间");-->
			<!--var s ={-->
				<!--"uname":uname,-->
				<!--"password":password ,-->
				<!--"sex": sex,-->
				<!--"email":email ,-->
				<!--"identity":identity,-->
				<!--"phone":phone,-->
				<!--"birthday":birthday,-->
				<!--"signature":signature,-->
				<!--"address":address-->
			<!--}-->
			<!--var str = JSON.stringify(s);-->
			<!--$.ajax({-->
				<!--url:"/user/add",-->
				<!--type:'POST',-->
				<!--dataType: 'json',-->
				<!--contentType: 'application/json',-->
				<!--data:str,-->
				<!--success:function (result) {-->
					<!--console.log(result.success);-->
					<!--if(result.success===false)-->
					<!--{-->
						<!--alert(result.message);-->
						<!--window.location.href='/user/form';-->
					<!--}-->
					<!--alert("注册成功！去登录")-->
					<!--window.location.href='/b';-->
				<!--}-->
			<!--});-->
		<!--})-->
	<!--});-->

	<!--//-->
	<!--// })-->
<!--</script>-->
<script>

    new Vue({
        el:'#useradd',
        data: function () {
            return {
                count:'',
                ruleForm: {
                    uname: '',
                    sex: '',
                    password: '',
                    email: '',
                    phone: '',
                    birthday: '',
                    address: '',
                    identity: '',
                    signature:''
                },
                rules: {
                    uname: [
                        { required: true, message: '请输入用户名', trigger: 'blur' },
                        {
                            pattern: /^[\u4E00-\u9FA5]+$/,  //正则
                            message: '用户名只能为中文'
                        }
//                      { min: 2, max: 5, message: '长度在 3 到 5 个字符', trigger: 'blur' }
//                      {pattern: ^[\\u4e00-\\u9fa5]{2,5}+$ , message: '用户名为2-5个中文',trigger: 'blur'}
                    ],
                    password: [
                        { required: true, message: '请输入密码', trigger: 'blur' },
                        { pattern: /^\d{6}$/, message: '请输入6位数字密码', trigger: 'blur' }
                    ],
                    email: [
                        { type: 'email', required: true, message: '请输入邮箱', trigger: 'blur' },

                        {pattern: /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,
                            message: '邮箱格式不正确'
                        }
                    ],
                    phone: [
                        {  required: true, message: '请输入手机号', trigger: 'blur' },

                        {pattern: /^((1[3-8][0-9])+\d{8})$/,
                            message: '手机号格式不正确'
                        }
                    ],
                    birthday: [
                        { required: true, message: '请选择出生日期', trigger: 'blur' }
                    ],
                    address: [
                        { required: true, message: '请输入住址', trigger: 'blur' }
                    ],
                    identity: [
                        { required: true, message: '请输入身份证号', trigger: 'blur' }

                    ],
                    sex: [
                        { required: true, message: '请选择性别', trigger: 'blur' }
                    ],
                }
            };

        },
        create(){

        },
        methods: {
            submitForm(ruleF) {
                this.$refs[ruleF].validate((valid) => {
                    if (valid) {
                        axios.post('/adduserservice', JSON.stringify(this.ruleForm), {
                                headers: {
                                    'Content-Type': 'application/json;charset=UTF-8'
                                }
                            }
                        ).then(req => {
                            if(req.data.succsee==false){
                                this.$message.error(req.data.message);
                                return false;
                            }
                            else{
                                this.$message({message: '注册成功！', type: 'success'});
                                this.goGrdoupRecor()

                            }
                        })
                    } else {
                        this.$message({message: '请填写好信息！', type: 'error'});
                        return false;
                    }
                });

                // this.$refs[formName].validate((valid) => {
                //     if (valid) {
                //         alert('submit!');
                //     } else {
                //         console.log('error submit!!');
                //         return false;
                //     }
                // });
            },
            goGrdoupRecor(){
                const TIME_COUNT = 2;
                if(!this.timer){
                    this.count = TIME_COUNT;
                    this.show = false;
                    this.timer = setInterval(()=>{
                        if(this.count > 0 && this.count <= TIME_COUNT){
                            this.count--;
                        }else{
                            this.show = true;
                            clearInterval(this.timer);
                            this.timer = null;
                            this.ruleForm={
                                uname: '',
                                    sex: '',
                                    password: '',
                                    email: '',
                                    phone: '',
                                    birthday: '',
                                    address: '',
                                    identity: '',
                                    signature:''
                            },
                            //跳转的页面写在此处
                            window.location.href="/";

                        }
                    },1000)
                }
            },
            resetForm(formName) {
                this.$refs[formName].resetFields();
            }
        },
    })
</script>
<style>
    .el-form-item{
        height:50px;
    }
</style>
</body>

</html>